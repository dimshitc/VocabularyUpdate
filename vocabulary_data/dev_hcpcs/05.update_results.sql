SET TERMOUT ON
SET LINESIZE 3000
SET PAGESIZE 45
SET SERVEROUTPUT ON
SET VERIFY OFF
/* If any errors occurs - stop script execution and return error code */
WHENEVER SQLERROR EXIT SQL.SQLCODE
/*
 *****************************
 *  Log to file...    
 *****************************
*/
SPOOL &1

/**
* Perform update results verification
**/
SET ECHO OFF
-- Define column width
COLUMN CHECK_ID FORMAT A20 HEADING 'CHECK_ID' NULL - WRAP
COLUMN CONCEPT_ID_1 FORMAT A20 HEADING 'CONCEPT_ID_1' NULL - WRAP
COLUMN CONCEPT_ID_2 FORMAT A20 HEADING 'CONCEPT_ID_2' NULL - WRAP
COLUMN RELATIONSHIP_ID FORMAT A20 HEADING 'RELATIONSHIP_ID' NULL - WRAP
COLUMN VALID_START_DATE FORMAT A10 HEADING 'VALID_START_DATE' NULL - WRAP
COLUMN VALID_END_DATE FORMAT A10 HEADING 'VALID_END_DATE' NULL - WRAP
COLUMN INVALID_REASON FORMAT A10 HEADING 'INVALID_REASON' NULL - WRAP

SET ECHO ON
-- Perform common checks
SELECT * FROM TABLE(devv5.qa_tests.get_checks);
SET ECHO OFF

-- Define column width
COLUMN VOCABULARY_ID_1 FORMAT A20 HEADING 'VOCABULARY_ID_1' NULL - WRAP
COLUMN VOCABULARY_ID_2 FORMAT A20 HEADING 'VOCABULARY_ID_2' NULL - WRAP
COLUMN CONCEPT_CLASS_ID FORMAT A20 HEADING 'CONCEPT_CLASS_ID' NULL - WRAP
COLUMN RELATIONSHIP_ID FORMAT A20 HEADING 'RELATIONSHIP_ID' NULL - WRAP
COLUMN INVALID_REASON FORMAT A10 HEADING 'INVALID_REASON' NULL - WRAP
COLUMN CONCEPT_DELTA FORMAT 999999999.99 HEADING 'CONCEPT_DELTA' NULL - WRAP

SET ECHO ON
-- Perform CONCEPT checks
SELECT * FROM TABLE(devv5.qa_tests.get_summary('concept'));

-- Perform CONCEPT RELATIONSHIPS checks
SELECT * FROM TABLE(devv5.qa_tests.get_summary('concept_relationship'));

-- Perform CONCEPT ANCESTORS checks
SELECT * FROM TABLE(devv5.qa_tests.get_summary('concept_ancestor'));

EXIT